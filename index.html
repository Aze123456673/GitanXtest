<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>DÃ©obfuscateur Lua - WeAreDevs & Street Fix 2026</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0d001a, #1a0033);
    color: #d0c0ff;
    margin: 0;
    padding: 20px;
  }
  .container { max-width: 1100px; margin: auto; }
  h1 { color: #bb66ff; text-align: center; margin-bottom: 0.6em; }
  .info { text-align: center; color: #aa88ff; font-size: 0.95rem; margin: 12px 0; }
  .mode-select { text-align: center; margin: 16px 0; }
  select {
    padding: 8px 16px;
    font-size: 1rem;
    background: #222244;
    color: #fff;
    border: 1px solid #664488;
    border-radius: 4px;
  }
  textarea {
    width: 100%;
    max-width: 1000px;
    height: 340px;
    margin: 16px auto;
    display: block;
    background: #111122;
    color: #e0d0ff;
    border: 1px solid #553366;
    border-radius: 8px;
    padding: 16px;
    font-family: monospace;
    font-size: 14px;
    resize: vertical;
  }
  button {
    display: block;
    margin: 24px auto;
    padding: 16px 60px;
    font-size: 1.35rem;
    background: #7f00ff;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover {
    background: #9f40ff;
    transform: scale(1.05);
  }
  #result {
    width: 100%;
    max-width: 1000px;
    margin: 20px auto;
    background: #0a0011;
    border: 1px solid #442266;
    border-radius: 8px;
    padding: 20px;
    white-space: pre-wrap;
    font-family: monospace;
    min-height: 220px;
    color: #b0ffb0;
    line-height: 1.45;
  }
  .error { color: #ff9999 !important; background: rgba(255,100,100,0.15); }
</style>
</head>
<body>

<div class="container">
  <h1>DÃ©obfuscateur Lua (WeAreDevs v1 & Street)</h1>
  <div class="info">Colle ton code obfusquÃ© â†’ choisis mode â†’ clique sur le bouton</div>

  <div class="mode-select">
    <label for="mode">Mode : </label>
    <select id="mode">
      <option value="general">GÃ©nÃ©ral (basique)</option>
      <option value="wearedevs" selected>WeAreDevs v1.x</option>
      <option value="street">Street / XOR basique</option>
    </select>
  </div>

  <textarea id="input" placeholder="Colle ton code Lua obfusquÃ© ici... (ex: b={\"\\104\\101\\108\\108\\111\"} ...)"></textarea>

  <button onclick="deobfuscate()">DÃ‰OBFUSQUER ðŸ”¥</button>

  <div id="result">RÃ©sultat ici... (si rien ne change, essaie un autre mode)</div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PATTERNS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const generalPatterns = [
  { regex: /loadstring\s*\(/gi, replace: 'load(' },
  { regex: /\\x([0-9a-fA-F]{2})/gi, replace: (_, h) => String.fromCharCode(parseInt(h, 16)) },
  { regex: /\\([0-7]{1,3})/g, replace: (_, o) => String.fromCharCode(parseInt(o, 8)) },
  {
    regex: /\b_\s*=\s*([^:]+?)\s*:\s*gsub\s*\(\s*"([^"]+)"\s*,\s*"([^"]*)"\s*\)/gi,
    replace: (m, src, pat, rep) => {
      try {
        const safePat = pat.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        return src.replace(new RegExp(safePat, 'g'), rep);
      } catch {
        return m;
      }
    }
  }
];

const wearedevsPatterns = [
  // DÃ©codeur octal ULTRA ROBUSTE
  {
    regex: /"((?:\\?\d{1,3})+)"/g,
    replace: (match, content) => {
      try {
        let decoded = '';
        let i = 0;
        while (i < content.length) {
          if (content[i] === '\\' && /\d/.test(content[i+1])) {
            let num = '';
            i++;
            while (i < content.length && /\d/.test(content[i]) && num.length < 3) {
              num += content[i++];
            }
            decoded += String.fromCharCode(parseInt(num, 8));
          } else if (/\d/.test(content[i])) {
            let num = '';
            while (i < content.length && /\d/.test(content[i]) && num.length < 3) {
              num += content[i++];
            }
            decoded += String.fromCharCode(parseInt(num, 8));
          } else {
            decoded += content[i++];
          }
        }
        return `"${decoded.replace(/"/g,'\\"').replace(/\n/g,'\\n')}"`;
      } catch (e) {
        return match;
      }
    }
  },
  // Supprime mapping et boucles decode (le plus frÃ©quent)
  { regex: /local\s+[a-zA-Z_]\s*=\s*{[^}]*}/gi, replace: '// Table de mapping supprimÃ©e' },
  { regex: /for\s+[a-zA-Z_]\s*=\s*[^,]+?,\s*#[^,]+?,\s*[^)]+?\s*do[\s\S]*?end/gi, replace: '// Boucle de dÃ©codage supprimÃ©e' }
];

function deobfuscate() {
  const inputEl = document.getElementById('input');
  const mode = document.getElementById('mode').value;
  const resultEl = document.getElementById('result');

  const input = inputEl.value.trim();
  if (!input) {
    resultEl.innerHTML = "Colle un script obfusquÃ© d'abord bg ðŸ˜";
    resultEl.className = 'error';
    return;
  }

  let code = input;

  // Toujours appliquer gÃ©nÃ©ral
  generalPatterns.forEach(p => {
    code = code.replace(p.regex, typeof p.replace === 'function' ? p.replace : p.replace);
  });

  // Mode spÃ©cifique
  if (mode === 'wearedevs') {
    wearedevsPatterns.forEach(p => {
      code = code.replace(p.regex, typeof p.replace === 'function' ? p.replace : p.replace);
    });

    // Double passe sur les strings (trÃ¨s utile pour WeAreDevs)
    code = code.replace(/"((?:\\?\d{1,3})+)"/g, wearedevsPatterns[0].replace);
  }

  // Nettoyage doux
  code = code
    .replace(/\s{3,}/g, '  ')      // espaces multiples â†’ 2 max
    .replace(/;\s*/g, ';\n')
    .replace(/(\bend\b)/gi, '\n$1\n')
    .replace(/(\bthen\b)/gi, '\n$1\n')
    .replace(/(\belse\b)/gi, '\n$1\n')
    .replace(/(\belseif\b)/gi, '\n$1 ')
    .trim();

  if (code.length < 60 || code === input) {
    resultEl.innerHTML = "(Presque rien rÃ©cupÃ©rÃ©...)\nEssaie l'autre mode ou colle un script WeAreDevs avec table b={...}";
    resultEl.className = 'error';
  } else {
    resultEl.textContent = code;
    resultEl.className = '';
  }
}
</script>
</body>
</html>
