<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>DÃ©obfuscateur Lua - Grok Edition 2026 (WeAreDevs v1 boost)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
  body { font-family: 'Segoe UI', sans-serif; background: #0d001a; color: #d0c0ff; margin:0; padding:20px; background: linear-gradient(135deg, #0d001a, #1a0033); }
  h1 { color: #bb66ff; text-align:center; }
  textarea { width:100%; max-width:1000px; height:280px; margin:16px auto; display:block; background:#111122; color:#e0d0ff; border:1px solid #553366; border-radius:8px; padding:16px; font-family:monospace; font-size:14px; }
  button { display:block; margin:20px auto; padding:14px 40px; font-size:1.2rem; background:#7f00ff; color:white; border:none; border-radius:6px; cursor:pointer; transition:0.3s; }
  button:hover { background:#9f40ff; transform:scale(1.05); }
  #result { width:100%; max-width:1000px; margin:20px auto; background:#0a0011; border:1px solid #442266; border-radius:8px; padding:18px; white-space:pre-wrap; font-family:monospace; min-height:180px; color:#b0ffb0; }
  .mode-select { text-align:center; margin:16px; }
  select { padding:8px 16px; font-size:1rem; background:#222244; color:#fff; border:1px solid #664488; border-radius:4px; }
</style>
</head>
<body>

<div style="max-width:1100px;margin:auto;">
  <h1>DÃ©obfuscateur Lua (Street + WeAreDevs v1.0.0)</h1>
  
  <div class="mode-select">
    <label>Mode : </label>
    <select id="mode">
      <option value="general">GÃ©nÃ©ral (basique)</option>
      <option value="wearedevs" selected>WeAreDevs v1.0.0</option>
    </select>
  </div>

  <textarea id="input" placeholder="Colle ton code Lua obfusquÃ© ici... (WeAreDevs v1 ou autre)"></textarea>
  
  <button onclick="deobfuscate()">DÃ‰OBFUSQUER MAINTENANT ðŸ”¥</button>
  
  <div id="result">RÃ©sultat ici... (essaie le mode WeAreDevs pour les vieux obfu WAD)</div>
</div>

<script>
// Patterns gÃ©nÃ©raux (comme avant)
const generalPatterns = [
  { regex: /loadstring\s*\(/g,     replace: 'load(' },
  { regex: /\\x([0-9a-fA-F]{2})/g, (_, h) => String.fromCharCode(parseInt(h,16)) },
  { regex: /\\([0-7]{1,3})/g,      (_, o) => String.fromCharCode(parseInt(o,8))  },
  // gsub chain typique
  { regex: /\b_\s*=\s*([^:]+?)\s*:\s*gsub\s*\(\s*"([^"]+)"\s*,\s*"([^"]*)"\s*\)/g,
    replace: (m, s, p, r) => s.replace(new RegExp(p.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'g'), r) }
];

// Patterns spÃ©cifiques WeAreDevs v1.0.0 (string table + mapping + shift/add)
const wearedevsPatterns = [
  // DÃ©codage octal basique des strings dans la table b = {"\122\073\056"...}
  { regex: /"\\(\d{1,3}(?:\\(\d{1,3}))*)"/g, 
    replace: (match, p1) => {
      let str = '';
      p1.split('\\').filter(Boolean).forEach(o => str += String.fromCharCode(parseInt(o,8)));
      return `"${str.replace(/"/g,'\\"')}"`;
    }
  },
  // Tentative de simplification du mapping o = {D=..., T=..., ...} avec les calculs Ã  la con
  { regex: /local\s+o\s*=\s*{[^}]+}/g, replace: '// MAPPING TABLE REMOVED (WeAreDevs junk)' },
  // Remplace le loop de dÃ©codage par un commentaire (pas parfait mais aide Ã  lire)
  { regex: /for\s+b\s*=\s*[^,]+,\s*#[^,]+,\s*[^)]+\s*do\s*local\s*M\s*=\s*Z\[b\].*?end/g, 
    replace: '// WeAreDevs STRING DECODER LOOP - strings should be decoded above' }
];

function deobfuscate() {
  const input = document.getElementById('input').value.trim();
  const mode = document.getElementById('mode').value;
  const resultDiv = document.getElementById('result');

  if (!input) {
    resultDiv.innerHTML = "Mets du code quand mÃªme bg ðŸ˜";
    resultDiv.style.color = "#ff9999";
    return;
  }

  let code = input;

  // Ã‰tape 1 : toujours appliquer les patterns gÃ©nÃ©raux
  for (const p of generalPatterns) {
    if (typeof p.replace === 'function') {
      code = code.replace(p.regex, p.replace);
    } else {
      code = code.replace(p.regex, p.replace);
    }
  }

  // Ã‰tape 2 : si mode WeAreDevs activÃ© â†’ attaque spÃ©cifique
  if (mode === "wearedevs") {
    for (const p of wearedevsPatterns) {
      if (typeof p.replace === 'function') {
        code = code.replace(p.regex, p.replace);
      } else {
        code = code.replace(p.regex, p.replace);
      }
    }

    // Petit extra : tente de dÃ©coder les \xxx directement dans toute la string table
    code = code.replace(/"((?:\\\d{1,3})+)"/g, (m, content) => {
      try {
        let decoded = '';
        const octals = content.match(/\\(\d{1,3})/g) || [];
        for (const oct of octals) {
          decoded += String.fromCharCode(parseInt(oct.slice(1), 8));
        }
        return `"${decoded.replace(/"/g,'\\"').replace(/\n/g,'\\n')}"`;
      } catch {
        return m;
      }
    });
  }

  // Nettoyage final (indent un minimum, enlÃ¨ve les espaces inutiles)
  code = code
    .replace(/\s{2,}/g, ' ')
    .replace(/;\s*/g, ';\n')
    .replace(/end\s*/g, 'end\n')
    .replace(/then\s*/g, 'then\n')
    .replace(/else\s*/g, 'else\n')
    .trim();

  resultDiv.innerHTML = code || "(Pas grand chose rÃ©cupÃ©rÃ©... essaie un autre mode ou un autre script)";
  resultDiv.style.color = code.length > 100 ? "#b0ffb0" : "#ffaa99";
}
</script>
</body>
</html>
